<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Power Edit (Resume)</title>
  <link rel="stylesheet" href="https://unpkg.com/@picocss/pico@2/css/pico.min.css">
  <link rel="icon" href="data:,"><!-- avoid favicon 404 -->
  <style>
    :root { --pane-bg:#fff; --chip:#eef; --miss:#ffeaea; --hit:#eaffea; }
    body.container { max-width: 1200px; }
    .grid { display:grid; grid-template-columns: 1fr 1fr; gap:1rem; }
    #editor { border:1px solid #ddd; background:var(--pane-bg); min-height:60vh; padding:1rem; border-radius:8px; }
    #editor[contenteditable="true"]:focus { outline: 2px solid #bde; }
    .k { display:inline-block; padding:.25rem .5rem; border:1px solid #ccd; border-radius:999px; background:var(--chip); margin:.1rem; }
    .miss { background:var(--miss) !important; border-color:#f6c2c2 !important; }
    .hit  { background:var(--hit)  !important; border-color:#b7f7b7 !important; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }
    .toolbar { display:flex; gap:.5rem; flex-wrap:wrap; align-items:center; }
    .toolbar input[type=file] { max-width: 280px; }
    .right-rail { background:var(--pane-bg); border:1px solid #ddd; border-radius:8px; padding:1rem; }
    .suggestion { border:1px dashed #ccd; padding:.5rem; border-radius:8px; margin:.25rem 0; cursor:pointer; }
    .suggestion:hover { background:#f7f7ff; }
    .small { font-size:.875rem; color:#555; }
    .auto-insert { background:#f4fff4; outline:1px dashed #8fd48f; border-radius:6px; }
    #auto_hint { white-space:nowrap; }
    .pill { display:inline-block; padding:.2rem .5rem; border:1px solid #e0e0e0; border-radius:999px; background:#f7f7f7; font-size:.8rem; }
  </style>
</head>
<body class="container">
  <h2 style="display:flex;align-items:center;gap:.5rem">
    Power Edit (live)
    <span id="mode_badge" class="pill">Client‑only</span>
  </h2>

  <article class="toolbar">
    <input id="docx_file" type="file" accept=".docx"/>
    <button id="btn_export_docx" class="secondary">Export .docx</button>
    <button id="btn_print_pdf" class="secondary">Print / Save as PDF</button>

    <button id="btn_auto_server" class="contrast" title="Enabled after resume + JD" disabled>Auto-tailor (server)</button>
    <button id="btn_undo_auto" class="secondary" disabled>Undo</button>
    <button id="btn_clear_auto" class="secondary" disabled>Clear inserts</button>

    <span id="auto_hint" class="small muted" style="margin-left:6px;"></span>
    <span class="mono" id="scoreline" style="margin-left:auto">Score: —</span>
  </article>

  <div class="grid">
    <article>
      <details open>
        <summary>Job Description (paste here)</summary>
        <label>Title <input id="job_title" placeholder="e.g., Software Engineer I (Full‑Stack)"/></label>
        <label>Company <input id="job_company" placeholder="e.g., RoadRunner"/></label>
        <label>Location <input id="job_location" placeholder="e.g., Remote, USA"/></label>
        <label>Job Description <textarea id="job_desc" rows="10" placeholder="Paste JD text here..."></textarea></label>
      </details>

      <details>
        <summary>Profile (auto-fills if signed in)</summary>
        <textarea id="profile_json" rows="6" placeholder='{"skills":["excel","crm"],"target_titles":["coordinator"]}'></textarea>
      </details>

      <h4>Your Resume (editable)</h4>
      <div id="editor" contenteditable="true" spellcheck="true"></div>
      <p class="small">Paste a JD and load/paste your resume to enable scoring and Auto‑tailor. Click suggestions to weave them into the best existing bullet <em>after Education</em>. Undo/Clear supported.</p>
    </article>

    <article class="right-rail">
      <h4>Gaps & Coverage</h4>
      <div id="gaps" class="small muted">Paste a job description to see gaps.</div>
      <h5 style="margin-top:.75rem">Suggest inserts (click to weave)</h5>
      <div id="suggestions" class="small muted">Suggestions appear after you paste a JD.</div>
      <hr/>
      <h5>Keyword coverage</h5>
      <div id="coverage" class="small muted">Shown after JD is pasted.</div>
    </article>
  </div>

  <!-- Supabase config (same project values as profile.html) -->
  <script>
    window.SUPABASE_URL = "https://imozfqawxpsasjdmgdkh.supabase.co";
    window.SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imltb3pmcWF3eHBzYXNqZG1nZGtoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg1Njk3NTUsImV4cCI6MjA3NDE0NTc1NX0.fkGObZvEy-oUfLrPcwgTSJbc-n6O5aE31SGIBeXImtc";
  </script>
  <script defer src="https://unpkg.com/@supabase/supabase-js@2/dist/umd/supabase.js"></script>

  <!-- DOCX -> HTML (browser) -->
  <script defer src="https://unpkg.com/mammoth@1.5.1/mammoth.browser.min.js"></script>
  <!-- HTML -> DOCX -->
  <script defer src="https://cdn.jsdelivr.net/gh/evidenceprime/html-docx-js/dist/html-docx.js"></script>

  <!-- App (cache-busted) -->
  <script type="module" src="./js/power-edit.js?v=2025-10-12-1"></script>
</body>
</html>
